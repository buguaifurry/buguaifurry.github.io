<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>仿 iOS26 风格 个人导航页</title>
  <!-- 使用 TailwindCSS 快速美化（在线 CDN） -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 简单的 iOS 风格配色和玻璃质感 */
    :root{
      --bg-accent: rgba(255,255,255,0.06);
      --card-bg: rgba(255,255,255,0.06);
      --glass: rgba(255,255,255,0.08);
    }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Text", "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      background: #0b1220; /* 深色背景作衬托 */
      min-height:100vh;
    }
    /* 壁纸容器，支持背景图片、模糊和色彩叠加 */
    .wallpaper{
      position:fixed; inset:0; z-index:-10; background-size:cover; background-position:center;
      filter: saturate(1.05) contrast(1.02);
      transition: background-image .35s ease, transform .35s ease;
    }
    .wallpaper::after{
      /* 半透明渐变叠层，制造 iOS 风格轻薄质感 */
      content:""; position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,0.15), rgba(0,0,0,0.35));
      mix-blend-mode: multiply;
    }
    /* iOS 风格卡片阴影与圆角 */
    .glass-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      backdrop-filter: blur(8px) saturate(1.1);
      border: 1px solid rgba(255,255,255,0.04);
      border-radius: 16px;
    }
    /* 圆形头像边框效果 */
    .avatar-outer{border:2px solid rgba(255,255,255,0.06); padding:3px; border-radius:999px}
    /* 小图标风格 */
    .app-icon{width:68px;height:68px;border-radius:18px;display:flex;align-items:center;justify-content:center;font-weight:600}
    /* Dock */
    .dock{background:rgba(255,255,255,0.04);backdrop-filter: blur(6px);border-radius:18px;padding:8px 14px}
    /* 图标卡 hover */
    .icon-btn:hover{transform:translateY(-6px) scale(1.02)}
    .icon-btn{transition:all .18s ease}
    /* 工具提示 */
    .hint{font-size:12px;color:rgba(255,255,255,0.65)}
  </style>
</head>
<body>
  <!-- 壁纸：可通过右上角上传按钮更换 -->
  <div id="wallpaper" class="wallpaper" style="background-image: linear-gradient(135deg,#0b1220,#071022);"></div>

  <main class="min-h-screen px-4 md:px-8 lg:px-20 py-8">
    <div class="max-w-4xl mx-auto">
      <!-- 顶部栏：时间 / 搜索 / 头像 -->
      <header class="flex items-center justify-between mb-6">
        <div>
          <div class="text-white text-3xl font-semibold" id="time">--:--</div>
          <div class="hint">个人导航 / 仿 iOS26 风格</div>
        </div>

        <div class="flex items-center gap-4">
          <!-- 搜索框 -->
          <div class="glass-card flex items-center gap-3 px-3 py-2 shadow-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white/70" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M21 21l-4.35-4.35"/><circle cx="11" cy="11" r="6" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <input id="search" placeholder="搜索或输入网址" class="bg-transparent placeholder-white/60 focus:outline-none text-white" />
          </div>

          <!-- 头像（可替换） -->
          <div class="avatar-outer cursor-pointer" id="avatarBtn" title="点击更换头像">
            <img id="avatarImg" src="https://images.unsplash.com/photo-1527980965255-d3b416303d12?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder" alt="avatar" class="w-12 h-12 rounded-full object-cover" />
          </div>

          <!-- 壁纸更换按钮 -->
          <button id="changeWallpaperBtn" class="glass-card px-3 py-2 text-sm">更换壁纸</button>
        </div>
      </header>

      <!-- 主体：图标网格 -->
      <section class="grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-4 mb-8">
        <!-- 示例图标：可点击编辑图片与链接 -->
      </section>

      <!-- Dock（底部常驻） -->
      <div class="fixed left-1/2 transform -translate-x-1/2 bottom-8 w-[min(920px,92%)] flex items-center justify-center z-40">
        <div class="dock w-full flex items-center justify-between px-4 glass-card">
          <div class="flex items-center gap-4">
            <div class="app-icon bg-white/6 rounded-xl flex items-center justify-center text-white/90">F</div>
            <div class="app-icon bg-white/6 rounded-xl flex items-center justify-center text-white/90">M</div>
            <div class="app-icon bg-white/6 rounded-xl flex items-center justify-center text-white/90">C</div>
          </div>
          <div class="hint">长按或点击图标可编辑（移动端：长按）</div>
        </div>
      </div>

      <!-- 隐藏的文件输入控件（替换壁纸和头像与图标） -->
      <input id="fileInput" type="file" accept="image/*" class="hidden" />

      <!-- 小说明 -->
      <div class="mt-6 text-sm text-white/70">提示：点击右上"更换壁纸"或头像来替换图片，图标区点击即可编辑单个图标与链接，支持本地图片上传并会保存在本地浏览器（localStorage）。</div>
    </div>
  </main>

  <!-- 编辑模态框（微交互） -->
  <div id="editorModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40">
    <div class="glass-card w-[min(720px,95%)] p-6">
      <h3 class="text-xl text-white mb-3">编辑图标</h3>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <div class="mb-2 text-sm text-white/80">图标预览</div>
          <div id="editorPreview" class="w-28 h-28 rounded-lg flex items-center justify-center">ICON</div>
          <button id="replaceIconBtn" class="mt-3 glass-card px-3 py-2">更换图标</button>
        </div>
        <div>
          <label class="block text-sm text-white/80 mb-1">名称</label>
          <input id="editorName" class="w-full p-2 bg-transparent border border-white/6 rounded" />
          <label class="block text-sm text-white/80 mb-1 mt-3">链接 (http(s)://)</label>
          <input id="editorHref" class="w-full p-2 bg-transparent border border-white/6 rounded" />
          <div class="flex gap-2 mt-4">
            <button id="saveIconBtn" class="px-4 py-2 glass-card">保存</button>
            <button id="deleteIconBtn" class="px-4 py-2 glass-card">删除</button>
            <button id="closeEditorBtn" class="px-4 py-2 glass-card">关闭</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========== 简短中文注释说明 ===========
    // 1) 页面支持修改：壁纸、头像、每个图标（图片 + 名称 + 链接）
    // 2) 数据保存在 localStorage，刷新后仍然存在（仅在本浏览器/设备）
    // 3) 若要恢复初始，请清除 localStorage 中的 ios26_nav_data 键

    const stateKey = 'ios26_nav_data_v1';

    // 默认图标数据（示例）
    const defaultIcons = [
      {id: '1', name: '博客', href: 'https://example.com', img: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'},
      {id: '2', name: 'GitHub', href: 'https://github.com', img: 'https://images.unsplash.com/photo-1523475496153-3d6cc55b1f8b?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'},
      {id: '3', name: '音乐', href: 'https://music.example', img: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'},
      {id: '4', name: '笔记', href: 'https://note.example', img: 'https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'},
      {id: '5', name: '相册', href: '#', img: 'https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'},
      {id: '6', name: '设置', href: '#', img: 'https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'}
    ];

    // 读取 / 初始化数据
    function loadState(){
      const raw = localStorage.getItem(stateKey);
      if(!raw) {
        const initial = { wallpaper: null, avatar: null, icons: defaultIcons };
        localStorage.setItem(stateKey, JSON.stringify(initial));
        return initial;
      }
      try{
        return JSON.parse(raw);
      } catch(e){
        const initial = { wallpaper: null, avatar: null, icons: defaultIcons };
        localStorage.setItem(stateKey, JSON.stringify(initial));
        return initial;
      }
    }
    function saveState(s){ localStorage.setItem(stateKey, JSON.stringify(s)); }

    let state = loadState();

    // 时间显示
    function tickTime(){
      const t = new Date();
      const hh = String(t.getHours()).padStart(2,'0');
      const mm = String(t.getMinutes()).padStart(2,'0');
      document.getElementById('time').textContent = hh+':'+mm;
    }
    tickTime(); setInterval(tickTime, 1000*30);

    // 更新壁纸显示
    const wallpaperEl = document.getElementById('wallpaper');
    function applyWallpaper(){
      if(state.wallpaper){
        wallpaperEl.style.backgroundImage = `url(${state.wallpaper})`;
      } else {
        wallpaperEl.style.backgroundImage = 'linear-gradient(135deg,#0b1220,#071022)';
      }
    }
    applyWallpaper();

    // 头像
    const avatarImg = document.getElementById('avatarImg');
    function applyAvatar(){
      if(state.avatar){ avatarImg.src = state.avatar; }
    }
    applyAvatar();

    // 渲染图标网格
    const grid = document.querySelector('section');
    function renderIcons(){
      grid.innerHTML = ''; // 清空
      state.icons.forEach(icon => {
        const btn = document.createElement('button');
        btn.className = 'glass-card flex flex-col items-center p-3 icon-btn';
        btn.innerHTML = `
          <div class=\"app-icon bg-white/6 rounded-xl mb-2 overflow-hidden\"> <img src=\"${icon.img}\" alt=\"${icon.name}\" class=\"w-full h-full object-cover\"/> </div>
          <div class=\"text-sm text-white/85 truncate\">${icon.name}</div>
        `;

        // 点击打开链接
        btn.addEventListener('click', (e)=>{
          // 普通点击：打开链接
          if(e.detail === 1){ // 单击
            if(icon.href && icon.href!=='#') window.open(icon.href, '_blank');
          }
        });

        // 右键或长按：编辑
        btn.addEventListener('contextmenu', (ev)=>{ ev.preventDefault(); openEditor(icon.id); });
        // 移动端长按支持（长按 600ms）
        let pressTimer = null;
        btn.addEventListener('touchstart', ()=>{ pressTimer = setTimeout(()=> openEditor(icon.id), 600); });
        btn.addEventListener('touchend', ()=>{ if(pressTimer) clearTimeout(pressTimer); });

        grid.appendChild(btn);
      });
    }
    renderIcons();

    // 编辑模态框逻辑
    const modal = document.getElementById('editorModal');
    const editorPreview = document.getElementById('editorPreview');
    const editorName = document.getElementById('editorName');
    const editorHref = document.getElementById('editorHref');
    const replaceIconBtn = document.getElementById('replaceIconBtn');
    let editingId = null;

    function openEditor(id){
      editingId = id;
      const icon = state.icons.find(i=>i.id===id);
      if(!icon) return;
      editorPreview.innerHTML = `<img src='${icon.img}' class='w-28 h-28 rounded-lg object-cover'/>`;
      editorName.value = icon.name;
      editorHref.value = icon.href || '';
      modal.classList.remove('hidden');
      modal.classList.add('flex');
    }
    document.getElementById('closeEditorBtn').addEventListener('click', ()=>{ modal.classList.add('hidden'); modal.classList.remove('flex'); });

    document.getElementById('saveIconBtn').addEventListener('click', ()=>{
      const icon = state.icons.find(i=>i.id===editingId);
      if(!icon) return;
      icon.name = editorName.value || icon.name;
      icon.href = editorHref.value || icon.href;
      saveState(state); renderIcons(); modal.classList.add('hidden'); modal.classList.remove('flex');
    });
    document.getElementById('deleteIconBtn').addEventListener('click', ()=>{
      state.icons = state.icons.filter(i=>i.id!==editingId);
      saveState(state); renderIcons(); modal.classList.add('hidden'); modal.classList.remove('flex');
    });

    // 替换图标图片
    replaceIconBtn.addEventListener('click', ()=>{ triggerFileInput('icon'); });

    // 全局文件输入处理（用于壁纸/头像/图标）
    const fileInput = document.getElementById('fileInput');
    let pendingTarget = null; // 'wallpaper' | 'avatar' | 'icon'
    fileInput.addEventListener('change', async (e)=>{
      const f = e.target.files[0];
      if(!f) return;
      const data = await fileToDataUrl(f);
      if(pendingTarget === 'wallpaper'){
        state.wallpaper = data; saveState(state); applyWallpaper();
      } else if(pendingTarget === 'avatar'){
        state.avatar = data; saveState(state); applyAvatar();
      } else if(pendingTarget === 'icon'){
        const icon = state.icons.find(i=>i.id===editingId);
        if(icon){ icon.img = data; saveState(state); renderIcons(); editorPreview.innerHTML = `<img src='${data}' class='w-28 h-28 rounded-lg object-cover'/>`; }
      }
      fileInput.value = '';
      pendingTarget = null;
    });

    function fileToDataUrl(f){ return new Promise((res, rej)=>{ const r=new FileReader(); r.onload=(e)=>res(e.target.result); r.onerror=rej; r.readAsDataURL(f); }); }

    // 触发文件选择
    function triggerFileInput(target){ pendingTarget = target; fileInput.click(); }
    document.getElementById('changeWallpaperBtn').addEventListener('click', ()=> triggerFileInput('wallpaper'));
    document.getElementById('avatarBtn').addEventListener('click', ()=> triggerFileInput('avatar'));

    // 搜索框按下 Enter 时打开链接或搜索
    document.getElementById('search').addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){
        const v = e.target.value.trim();
        if(!v) return;
        const url = v.match(/^https?:\/\//) ? v : `https://www.google.com/search?q=${encodeURIComponent(v)}`;
        window.open(url, '_blank');
      }
    });

    // 新增图标（如果图标少于 18 个，创建一个占位项）
    function ensureSlots(){
      const maxSlots = 18;
      if(state.icons.length < maxSlots){
        const nextId = Date.now().toString();
        const slotsToAdd = Math.min(maxSlots - state.icons.length, 6);
        for(let i=0;i<slotsToAdd;i++){
          state.icons.push({id: (Date.now()+i).toString(), name: '未命名', href:'#', img:'https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?q=80&w=200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder'});
        }
        saveState(state);
        renderIcons();
      }
    }
    ensureSlots();

    // 页面首次加载时从 localStorage 恢复壁纸/头像
    // 提供一个快捷键：按 R 可重置为默认
    document.addEventListener('keydown',(e)=>{
      if(e.key.toLowerCase()==='r' && (e.ctrlKey||e.metaKey)){
        if(confirm('确认重置导航页为初始状态吗？(会清除本地保存)')){ localStorage.removeItem(stateKey); state = loadState(); applyWallpaper(); applyAvatar(); renderIcons(); }
      }
    });

    // 如果用户没有自定义壁纸，则使用渐变；否则使用上传的图片
    applyWallpaper();

  </script>
</body>
</html>
